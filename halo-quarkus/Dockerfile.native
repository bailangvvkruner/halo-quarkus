# 使用 Distroless 镜像（最小化）
FROM gcr.io/distroless/base-debian12

WORKDIR /app

# 复制 Native 可执行文件（从本地或 CI 构建的）
COPY halo-core/target/halo-core-1.0.0-SNAPSHOT-runner /app/halo

# Halo 环境变量
ENV HALO_WORK_DIR=/root/.halo2

# 设置用户
USER 65534:65534

EXPOSE 8090

ENTRYPOINT ["/app/halo"]
